<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Omar Morando ">
<meta name="description" content="Penetration Test con un PLC La protezione di un ambiente ICS, inclusi i PLC, non è banale, poiché questi sistemi non sono progettati per essere resistenti ad attacchi cyber. Ciò significa che bisogna in qualche modo integrare le misure di resilienza della cybersicurezza all&amp;rsquo;interno e intorno all&amp;rsquo;ICS. Tali misure includono, ad esempio:
 la difesa perimetrale come i firewall per ridurre il rischio di traffico di rete indesiderato; il monitoraggio della rete e preferibilmente di tipo non intrusivo, specifico per ICS, basato su anomalie in modo da non creare alcun carico aggiuntivo sulle reti ICS; ultimo ma non meno importante, la protezione e il monitoraggio degli endpoint per ridurre l&amp;rsquo;esposizione dei PLC agli attacchi tramite connessioni remote." />
<meta name="keywords" content=", hacking, ot" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://www.omarmorando.com/posts/2021/07/hacking-pentest-con-un-plc/" />


    <title>
        
            Hacking: Pentest con un PLC :: Omar Morando 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://www.omarmorando.com/main.7b7bf28e97b43fde821383603355f080c106b57209430d897652d632ea36b75f.css">



    <link rel="apple-touch-icon" sizes="180x180" href="https://www.omarmorando.com/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://www.omarmorando.com/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://www.omarmorando.com/favicon-16x16.png">
    <link rel="manifest" href="https://www.omarmorando.com/site.webmanifest">
    <link rel="mask-icon" href="https://www.omarmorando.com/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://www.omarmorando.com/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Hacking: Pentest con un PLC">
<meta itemprop="description" content="Penetration Test con un PLC La protezione di un ambiente ICS, inclusi i PLC, non è banale, poiché questi sistemi non sono progettati per essere resistenti ad attacchi cyber. Ciò significa che bisogna in qualche modo integrare le misure di resilienza della cybersicurezza all&rsquo;interno e intorno all&rsquo;ICS. Tali misure includono, ad esempio:
 la difesa perimetrale come i firewall per ridurre il rischio di traffico di rete indesiderato; il monitoraggio della rete e preferibilmente di tipo non intrusivo, specifico per ICS, basato su anomalie in modo da non creare alcun carico aggiuntivo sulle reti ICS; ultimo ma non meno importante, la protezione e il monitoraggio degli endpoint per ridurre l&rsquo;esposizione dei PLC agli attacchi tramite connessioni remote."><meta itemprop="datePublished" content="2021-07-10T15:09:35+02:00" />
<meta itemprop="dateModified" content="2021-07-10T15:09:35+02:00" />
<meta itemprop="wordCount" content="818"><meta itemprop="image" content="https://www.omarmorando.com"/>
<meta itemprop="keywords" content="hacking,ot," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.omarmorando.com"/>

<meta name="twitter:title" content="Hacking: Pentest con un PLC"/>
<meta name="twitter:description" content="Penetration Test con un PLC La protezione di un ambiente ICS, inclusi i PLC, non è banale, poiché questi sistemi non sono progettati per essere resistenti ad attacchi cyber. Ciò significa che bisogna in qualche modo integrare le misure di resilienza della cybersicurezza all&rsquo;interno e intorno all&rsquo;ICS. Tali misure includono, ad esempio:
 la difesa perimetrale come i firewall per ridurre il rischio di traffico di rete indesiderato; il monitoraggio della rete e preferibilmente di tipo non intrusivo, specifico per ICS, basato su anomalie in modo da non creare alcun carico aggiuntivo sulle reti ICS; ultimo ma non meno importante, la protezione e il monitoraggio degli endpoint per ridurre l&rsquo;esposizione dei PLC agli attacchi tramite connessioni remote."/>



    <meta property="og:title" content="Hacking: Pentest con un PLC" />
<meta property="og:description" content="Penetration Test con un PLC La protezione di un ambiente ICS, inclusi i PLC, non è banale, poiché questi sistemi non sono progettati per essere resistenti ad attacchi cyber. Ciò significa che bisogna in qualche modo integrare le misure di resilienza della cybersicurezza all&rsquo;interno e intorno all&rsquo;ICS. Tali misure includono, ad esempio:
 la difesa perimetrale come i firewall per ridurre il rischio di traffico di rete indesiderato; il monitoraggio della rete e preferibilmente di tipo non intrusivo, specifico per ICS, basato su anomalie in modo da non creare alcun carico aggiuntivo sulle reti ICS; ultimo ma non meno importante, la protezione e il monitoraggio degli endpoint per ridurre l&rsquo;esposizione dei PLC agli attacchi tramite connessioni remote." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.omarmorando.com/posts/2021/07/hacking-pentest-con-un-plc/" /><meta property="og:image" content="https://www.omarmorando.com"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-10T15:09:35+02:00" />
<meta property="article:modified_time" content="2021-07-10T15:09:35+02:00" />







    <meta property="article:published_time" content="2021-07-10 15:09:35 &#43;0200 CEST" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://www.omarmorando.com/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">$</span>
            <span class="logo__text"> cd /home</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#a90c1c;
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://www.omarmorando.com/about/">01_About</a></li><li><a href="https://www.omarmorando.com/posts/">02_Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        4 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://www.omarmorando.com/posts/2021/07/hacking-pentest-con-un-plc/">Hacking: Pentest con un PLC</a>
      </h1>

      

      

      

      <div class="post-content">
        <h2 id="penetration-test-con-un-plc">Penetration Test con un PLC</h2>
<p>La protezione di un ambiente ICS, inclusi i PLC, non è banale, poiché questi sistemi non sono progettati per essere resistenti ad attacchi cyber. Ciò significa che bisogna in qualche modo integrare le misure di resilienza della cybersicurezza all&rsquo;interno e intorno all&rsquo;ICS. Tali misure includono, ad esempio:</p>
<ul>
<li>la difesa perimetrale come i firewall per ridurre il rischio di traffico di rete indesiderato;</li>
<li>il monitoraggio della rete e preferibilmente di tipo non intrusivo, specifico per ICS, basato su anomalie in modo da non creare alcun carico aggiuntivo sulle reti ICS;</li>
<li>ultimo ma non meno importante, la protezione e il monitoraggio degli endpoint per ridurre l&rsquo;esposizione dei PLC agli attacchi tramite connessioni remote.</li>
</ul>
<p>Ma un altro aspetto molto importante è identificare e comprendere i rischi. <strong>Quali sono le superfici di attacco, i metodi attuati, le vulnerabilità e le potenziali conseguenze?</strong> Inoltre, è importante valutare e rivalutare continuamente la probabilità di potenziali attacchi.</p>
<p><img src="https://www.omarmorando.com/uploads/2021/pt_1.png" alt=""></p>
<p>Un metodo per ottenere informazioni dettagliate sull&rsquo;esposizione al rischio è il <strong>test di penetrazione</strong>, il cui l&rsquo;obiettivo è identificare i vettori di attacco e simulare un vero e proprio attacco al sistema, controllato e consapevole. Tuttavia, i test di penetrazione in un ambiente ICS richiedono un approccio attento significativamente diverso rispetto alle tecniche di test di penetrazione standard per i sistemi IT. I sistemi ICS contengono apparecchiature delicate, come i PLC, dodate di un&rsquo;unità di elaborazione sensibile, che può causare congelamenti, ripristini della configurazione e guasti se sollecitati a causa della bassa gestione dello stack.</p>
<p>Test di penetrazione standard come una semplice scansione delle porte eseguita da strumenti come Nmap potrebbero essere sufficienti per sovraccaricare l&rsquo;unità di elaborazione. A causa della debole gestione dello stack di rete, alcuni dispositivi non sono in grado di sopportare il numero di pacchetti di rete generati da Nmap e strumenti simili. Pertanto, è consigliabile non eseguire test di penetrazione in un ambiente ICS live, ma eseguirli solo in un ambiente di laboratorio controllato o durante fermi macchina programmati.</p>
<p>Ci sono molte metodologie di test di penetrazione tra cui scegliere, anche se poche su misura per ICS. Una metodologia compatibile con ICS è la metodologia &ldquo;<strong>zero entry</strong>&rdquo; per i test di penetrazione. Essa comprende quattro fasi: <strong>reconnaissance, scanning, exploitation e post-exploitation</strong>.</p>
<p>Il post-exploitation potrebbe comportare il mantenimento dell&rsquo;accesso al sistema, che è ciò che fa un APT quando stabilisce un percorso per la comunicazione del centro di controllo e comando, che viene utilizzato per inviare informazioni di intelligence sul sistema di destinazione e per caricare nuovi exploit/malware. Inoltre, coprire le tracce per nascondere i passi dell&rsquo;attacco rappresenta il ​​quinto step.</p>
<p>La reconnaissance si concentra sulla raccolta di informazioni sulla destinazione, come ad esempio l&rsquo;indirizzo IP e i record DNS (Domain Name System) e la lettura delle vulnerabilità comuni per i PLC di destinazione. Lo scanning prevede la scansione attiva del target alla ricerca di porte aperte, il rilevamento del sistema operativo e l&rsquo;esecuzione dei servizi.</p>
<p>Nmap, incluso Nmap Script Engine (NSE), è un esempio di uno strumento che viene spesso utilizzato per la scansione. Nel caso in cui venga rilevata una vulnerabilità, la fase di attacco passa all&rsquo;exploitation. Nella maggior parte dei casi, tali vulnerabilità vengono utilizzate per ottenere l&rsquo;accesso al sistema attraverso diversi servizi in esecuzione sul PLC. Dopo aver sfruttaSploitkitto la vulnerabilità, è preferibile rendere persistente l&rsquo;accesso. Tuttavia, non tutti i servizi offrono l&rsquo;opportunità di creare una backdoor persistente.</p>
<p>Per molti PLC, è possibile estrarre dettagli sul sistema usando una scansione Nmap controllata verso il PLC stesso. Questo deve essere eseguito con cura per evitare di interromperne il funzionamento. Abbiamo una configurazione di laboratorio in cui eseguiamo test di penetrazione controllata su PLC e altre apparecchiature ICS, appartenenti a diversi produttori al fine di avere un campione rappresentativo di quanto presente sul mercato.</p>
<p>In uno dei test di penetrazione la scansione Nmap con l&rsquo;uso di script in Nmap Script Engine (NSE) ha rivelato l&rsquo;indirizzo MAC, le informazioni hardware e firmware, le porte aperte 80, 102 e 443 e altro ancora. Queste informazioni dettagliate possono essere utilizzate per sviluppare exploit e indagare le vulnerabilità verso le serie PLC specifiche.</p>
<p><img src="https://www.omarmorando.com/uploads/2021/pt_2.jpg" alt=""></p>
<p>Molte di queste vulnerabilità sono segnalate e discusse nel National Vulnerability Database. Sfruttando la loro presenza in molti casi è possibile decifrare la password e ottenere l&rsquo;accesso al PLC (e spegnerlo).</p>
<h2 id="nota-importante"><strong>Nota importante</strong></h2>
<p>Lo scopo di questo articolo è unicamente didattico e informativo. <strong>Ogni azione non autorizzata</strong> verso qualunque sistema di controllo presente su una rete pubblica o privata <strong>è illegale</strong>! Le informazioni contenute in questo ed altri articoli hanno lo scopo di far com‌prendere quanto sia necessario migliorare i sistemi di difesa, e non di fornire strumenti per effettuarne l&rsquo;attacco. Violare un sistema informatico è perseguibile penalmente e può causare gravi danni a cose e persone, in modo particolare se si parla di ICS. Tutti i test che vengono illustrati nei tutorials sono stati effettuati in laboratori isolati, sicuri, o autorizzati dal produttore.</p>
<p>Stay safe, stay free.</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://www.omarmorando.com/tags/hacking/">hacking</a></span>
        <span class="tag"><a href="https://www.omarmorando.com/tags/ot/">ot</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        818 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2021-07-10 15:09
        

         
          
        
      </p>
    </div>
      <hr />

    
    <div class="pagination">
        

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://www.omarmorando.com/posts/2021/07/hacking-attacco-tipo-stuxnet-a-un-plc-modicon/">
                    <span class="button__icon">←</span>
                    <span class="button__text">Hacking: attacco tipo Stuxnet a un PLC Modicon</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://www.omarmorando.com/posts/2021/07/hacking-attaccare-un-plc-con-stuxnet/">
                    <span class="button__text">Hacking: attaccare un PLC con Stuxnet</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            <span><a href="https://www.omarmorando.com">Omar Morando</a></span>
            
            
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span><span>Made with &#10084;</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="https://www.omarmorando.com/bundle.min.599099f1f14b78b657d524b28e10e0c5098e7cd46e9c7aed73d577068a276c3ff1bb234cbf29cb313333e83cf411727b43157c91ce5b809e2ffc81664614608e.js" integrity="sha512-WZCZ8fFLeLZX1SSyjhDgxQmOfNRunHrtc9V3BoonbD/xuyNMvynLMTMz6Dz0EXJ7QxV8kc5bgJ4v/IFmRhRgjg=="></script>



    </body>
</html>
